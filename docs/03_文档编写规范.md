# 文档编写规范

## 文档版本
- **版本号**: v1.0.0
- **创建日期**: 2026-01-19
- **最后更新**: 2026-01-19
- **文档状态**: 正式版

---

## 1. 文档编写原则

### 1.1 核心原则
1. **准确性**: 文档内容必须与代码实现保持一致
2. **完整性**: 覆盖所有必要的信息点
3. **可读性**: 使用清晰的语言和结构
4. **及时性**: 代码变更时同步更新文档
5. **可维护性**: 使用统一的格式和模板

### 1.2 文档哲学
- **代码即文档**: 优先编写自解释的代码
- **文档补充代码**: 解释"为什么"而非"是什么"
- **示例优于描述**: 提供实际的代码示例
- **图胜千言**: 适当使用图表和流程图

---

## 2. 文档分类与模板

### 2.1 规范类文档（00-09）

#### 模板结构
```markdown
# 文档标题

## 文档版本
- **版本号**: vX.Y.Z
- **创建日期**: YYYY-MM-DD
- **最后更新**: YYYY-MM-DD
- **文档状态**: 草稿/审核中/正式版

---

## 1. 概述
[简要说明文档目的和适用范围]

## 2. 核心内容
[主要规范内容]

## 3. 示例
[实际示例]

## 4. 常见问题
[FAQ]

## 5. 文档变更记录
| 版本 | 日期 | 修改人 | 修改内容 |
|------|------|--------|----------|
| v1.0.0 | YYYY-MM-DD | 姓名 | 初始版本 |
```

### 2.2 设计类文档（10-19）

#### 模板结构
```markdown
# 设计文档标题

## 文档信息
- **版本**: vX.Y.Z
- **作者**: [姓名]
- **日期**: YYYY-MM-DD
- **状态**: 设计中/已完成/已实现

---

## 1. 设计目标
[说明设计要达到的目标]

## 2. 设计方案
[详细设计方案]

## 3. 技术细节
[技术实现细节]

## 4. 设计决策
[重要的设计决策及理由]

## 5. 风险与限制
[潜在风险和限制]

## 6. 参考资料
[相关参考]
```

### 2.3 开发类文档（20-29）

#### API文档模板
```markdown
# API接口文档

## 接口概述
[接口用途说明]

## 接口详情

### 函数名称
**功能**: [简要描述]

**参数**:
- `param1` (类型): 参数说明
- `param2` (类型): 参数说明

**返回值**:
- 类型: 返回值类型
- 说明: 返回值含义

**异常**:
- `ExceptionType`: 异常情况说明

**示例**:
```python
# 代码示例
result = function_name(param1, param2)
```

**注意事项**:
- 注意点1
- 注意点2
```

### 2.4 测试类文档（30-39）

#### 测试用例模板
```markdown
# 测试用例

## 用例信息
- **用例ID**: TC-XXX
- **用例名称**: [测试场景]
- **优先级**: 高/中/低
- **测试类型**: 功能/性能/安全

## 测试步骤
1. 前置条件
2. 操作步骤
3. 预期结果

## 实际结果
[测试执行后填写]

## 测试数据
[所需测试数据]
```

---

## 3. Markdown格式规范

### 3.1 标题规范
```markdown
# 一级标题（文档标题，每个文档只有一个）

## 二级标题（主要章节）

### 三级标题（子章节）

#### 四级标题（细节说明）

##### 五级标题（尽量避免使用）
```

**规则**:
- 标题前后各空一行
- 标题与 `#` 之间有一个空格
- 不要跳级使用标题（如从二级直接到四级）

### 3.2 列表规范

#### 无序列表
```markdown
- 第一项
- 第二项
  - 子项1
  - 子项2
- 第三项
```

#### 有序列表
```markdown
1. 第一步
2. 第二步
   1. 子步骤1
   2. 子步骤2
3. 第三步
```

**规则**:
- 列表项之间不空行（紧凑列表）
- 子列表缩进2个空格
- 有序列表使用 `1.` 而非 `1)`

### 3.3 代码块规范

#### 行内代码
```markdown
使用 `变量名` 或 `函数名()` 表示代码元素
```

#### 代码块
````markdown
```python
def example_function():
    """函数说明"""
    return "Hello World"
```
````

**规则**:
- 必须指定语言类型（python, javascript, json等）
- 代码块前后各空一行
- 代码应该是可运行的完整示例

### 3.4 表格规范
```markdown
| 列1 | 列2 | 列3 |
|-----|-----|-----|
| 数据1 | 数据2 | 数据3 |
| 数据4 | 数据5 | 数据6 |
```

**规则**:
- 表头与数据之间用 `|---|` 分隔
- 列对齐使用 `|:---|` (左对齐), `|:---:|` (居中), `|---:|` (右对齐)
- 表格前后各空一行

### 3.5 链接与图片
```markdown
# 链接
[链接文字](URL)
[文档内链接](#章节标题)

# 图片
![图片描述](图片路径)
```

### 3.6 强调与引用
```markdown
**粗体文字**
*斜体文字*
~~删除线~~

> 引用文字
> 可以多行
```

### 3.7 分隔线
```markdown
---
```

---

## 4. 代码注释规范

### 4.1 Python注释规范

#### 模块注释
```python
"""
模块名称: grid_manager.py
功能描述: 网格管理器，负责网格的创建、更新和查询
作者: [姓名]
创建日期: 2026-01-19
最后修改: 2026-01-19
"""
```

#### 类注释
```python
class GridManager:
    """
    网格管理器类

    负责管理游戏网格的状态，包括瓦片的创建、旋转和连通性检测。

    Attributes:
        grid_size (int): 网格大小（NxN）
        tiles (List[List[Tile]]): 二维瓦片数组

    Example:
        >>> manager = GridManager(grid_size=4)
        >>> manager.rotate_tile(0, 0)
        >>> manager.check_connectivity()
        True
    """
```

#### 函数注释
```python
def rotate_tile(self, x: int, y: int) -> bool:
    """
    旋转指定位置的瓦片90度

    Args:
        x (int): 瓦片的X坐标（0-based）
        y (int): 瓦片的Y坐标（0-based）

    Returns:
        bool: 旋转成功返回True，否则返回False

    Raises:
        IndexError: 当坐标超出网格范围时
        ValueError: 当瓦片不可旋转时

    Example:
        >>> manager.rotate_tile(0, 0)
        True

    Note:
        旋转是顺时针90度，会触发连通性检测
    """
```

#### 行内注释
```python
# 检查瓦片是否可旋转（电源和终端不可旋转）
if tile.is_rotatable():
    tile.rotation = (tile.rotation + 90) % 360  # 顺时针旋转90度
```

**规则**:
- 使用三引号 `"""` 进行文档字符串注释
- 遵循Google风格或NumPy风格
- 复杂逻辑必须添加注释
- 注释应解释"为什么"而非"是什么"

### 4.2 配置文件注释

#### JSON注释（通过文档说明）
```json
{
  "level_id": "001",
  "grid_size": 4,
  "tiles": [
    {
      "x": 0,
      "y": 0,
      "type": "power_source",
      "rotation": 0
    }
  ]
}
```

**配置文档说明**:
```markdown
## 关卡配置格式

- `level_id`: 关卡唯一标识符（三位数字字符串）
- `grid_size`: 网格大小（4-8之间的整数）
- `tiles`: 瓦片数组
  - `x`: X坐标（0-based）
  - `y`: Y坐标（0-based）
  - `type`: 瓦片类型（见瓦片类型表）
  - `rotation`: 旋转角度（0/90/180/270）
```

---

## 5. 文档组织规范

### 5.1 文档命名规范
- 规范类: `0X_规范名称.md`（如 `03_文档编写规范.md`）
- 设计类: `1X_设计名称.md`（如 `10_UI设计规范.md`）
- 开发类: `2X_开发文档.md`（如 `20_API接口文档.md`）
- 测试类: `3X_测试文档.md`（如 `30_测试计划.md`）
- 运维类: `4X_运维文档.md`（如 `40_部署文档.md`）

### 5.2 文档版本管理
使用语义化版本号：`vX.Y.Z`

- **X (主版本号)**: 文档结构重大变更
- **Y (次版本号)**: 新增章节或重要内容
- **Z (修订号)**: 小修改、错误修正

### 5.3 文档状态标识
- **草稿**: 文档正在编写中
- **审核中**: 等待审核
- **正式版**: 已审核通过，可正式使用
- **已废弃**: 不再使用的文档

---

## 6. 特殊文档规范

### 6.1 README.md
```markdown
# 项目名称

简短的项目描述（一句话）

## 功能特性
- 特性1
- 特性2

## 快速开始

### 环境要求
- Python 3.8+
- 其他依赖

### 安装
```bash
pip install -r requirements.txt
```

### 运行
```bash
python main.py
```

## 项目结构
[简要说明目录结构]

## 文档
- [项目规划总纲](docs/00_项目规划总纲.md)
- [开发规范](docs/05_开发规范.md)

## 贡献指南
[如何贡献代码]

## 许可证
[许可证信息]
```

### 6.2 CHANGELOG.md
```markdown
# 变更日志

## [Unreleased]
### 新增
- 新功能描述

### 修改
- 修改内容

### 修复
- Bug修复

## [1.0.0] - 2026-01-19
### 新增
- 初始版本发布
```

### 6.3 CLAUDE.md
```markdown
# CLAUDE.md

本文档为Claude Code提供项目指导。

## 项目概述
[项目简介]

## 开发环境
[环境配置说明]

## 重要规范
[必须遵守的规范]

## 架构说明
[架构概览]

## 注意事项
[特别注意的点]
```

---

## 7. 文档质量检查清单

### 7.1 内容检查
- [ ] 文档标题清晰明确
- [ ] 包含版本信息
- [ ] 内容完整，无遗漏
- [ ] 示例代码可运行
- [ ] 术语使用一致
- [ ] 无拼写和语法错误

### 7.2 格式检查
- [ ] 标题层级正确
- [ ] 代码块指定语言
- [ ] 表格格式正确
- [ ] 链接有效
- [ ] 图片可显示
- [ ] 使用统一的缩进

### 7.3 可读性检查
- [ ] 段落长度适中
- [ ] 使用列表和表格组织信息
- [ ] 重要内容使用强调
- [ ] 提供足够的示例
- [ ] 逻辑清晰，易于理解

---

## 8. 文档工具推荐

### 8.1 Markdown编辑器
- **VS Code**: 配合Markdown插件
- **Typora**: 所见即所得编辑器
- **MarkText**: 开源Markdown编辑器

### 8.2 文档生成工具
- **Sphinx**: Python文档生成
- **MkDocs**: 项目文档站点
- **Doxygen**: 代码文档生成

### 8.3 图表工具
- **Draw.io**: 流程图、架构图
- **PlantUML**: 文本描述生成UML图
- **Mermaid**: Markdown内嵌图表

---

## 9. 文档审核流程

### 9.1 审核标准
1. **技术准确性**: 内容与实现一致
2. **完整性**: 覆盖所有必要信息
3. **可读性**: 易于理解
4. **规范性**: 符合本规范要求

### 9.2 审核流程
```
编写 → 自查 → 提交审核 → 审核反馈 → 修改 → 批准 → 发布
```

### 9.3 审核检查表
- [ ] 文档目的明确
- [ ] 内容准确无误
- [ ] 格式符合规范
- [ ] 示例完整可用
- [ ] 版本信息正确
- [ ] 变更记录完整

---

## 10. 常见问题

### Q1: 代码注释应该写多详细？
**A**: 遵循"代码即文档"原则：
- 简单代码：不需要注释，通过命名自解释
- 复杂逻辑：必须注释，解释"为什么"这样做
- 公共接口：必须有完整的文档字符串

### Q2: 文档更新频率？
**A**:
- 代码变更时：立即更新相关文档
- 定期审查：每个版本发布前审查所有文档
- 持续改进：发现问题随时修正

### Q3: 中英文如何混排？
**A**:
- 中文为主，关键术语提供英文对照
- 示例：网格管理器（Grid Manager）
- 代码和配置使用英文

### Q4: 如何处理废弃的文档？
**A**:
- 不要删除，标记为"已废弃"
- 在文档开头说明废弃原因和替代文档
- 移动到 `docs/archived/` 目录

---

## 11. 文档模板库

### 11.1 快速创建文档
```bash
# 使用工具脚本创建文档
python tools/scripts/create_doc.py --type=api --name=grid_api
```

### 11.2 模板文件位置
```
docs/templates/
├── template_specification.md    # 规范类模板
├── template_design.md           # 设计类模板
├── template_api.md              # API文档模板
└── template_test.md             # 测试文档模板
```

---

## 12. 文档变更记录

| 版本 | 日期 | 修改人 | 修改内容 |
|------|------|--------|----------|
| v1.0.0 | 2026-01-19 | Claude | 初始版本，定义文档编写标准 |

---

**重要提示**:
1. 所有文档必须遵循本规范
2. 文档质量与代码质量同等重要
3. 文档是团队协作的基础
4. 好的文档能大幅提升开发效率
